<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Dilan Motos - Catálogo autenticados</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/estilo_catalogoautenticado.css}">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <img src="/assets/LogoDylanMotosI.png" alt="Dilan Motos" class="logo">
    <div class="search-bar">
      <input type="text" placeholder="Buscar">
    </div>
    <div class="icons">
      <nav class="main-nav">
        <span class="money-icon">
          <a th:href="@{/pantallaCotizacion}">
            <img src="/assets/simboloPesos.png" alt="Pesos">
          </a>
        </span>
        <div class="user-menu">
          <span id="userIcon" class="user-icon">
            <img src="/assets/iconoPerfil.png" alt="Perfil">
          </span>
          <ul id="dropdown" class="dropdown hidden">
            <li><a th:href="@{/CuentaUsuario}">Mi cuenta</a></li>
            <li>
              <form th:action="@{/logout}" method="post" style="display:inline; width:100%;">
                <button type="submit" class="btn btn-link dropdown-logout"
                        style="width:100%; text-align:left; padding:0.6rem 1rem; color:#fff; text-decoration:none;">
                  Cerrar Sesión
                </button>
              </form>
            </li>
            <li sec:authorize="hasRole('ADMIN')">
              <a th:href="@{/usuario}" class="dropdown-admin">Panel de Administración</a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <!-- Contenido principal -->
  <div class="main-content">
    <!-- Filtros -->
    <div class="filters">
      <nav>
        <a th:href="@{/dashboard}">Inicio</a>
        <a th:href="@{/recomendacion}">Recomendaciones</a>
      </nav>
      <div class="filter-buttons">
        <ul class="topmenu">
          <li>
            <button>Marca</button>
            <ul>
              <!-- Opciones fijas añadidas manualmente -->
              <li><a th:href="@{/CatalogoKitArrastreAutenticado(marca='RK Takasago')}">RK Takasago</a></li>
              <li><a th:href="@{/CatalogoKitArrastreAutenticado(marca='DID Professional')}">DID Professional</a></li>
              <!-- Opción para mostrar todas -->
              <li><a th:href="@{/CatalogoKitArrastreAutenticado(marca='Todas')}">Todas</a></li>
            </ul>
          </li>
        </ul>
        <a th:href="@{/ComparacionProductos}" class="btn-accion">Comparar</a>
        <a th:href="@{/Reseñas}" class="btn-accion">Reseñas</a>
      </div>
    </div>

    <!-- Lista de Productos -->
    <div class="products">
      <div class="product-card" th:each="producto : ${productos}">
        <div class="select-circle" onclick="toggleSelect(this)">✔</div>
        <!-- Imagen: si tienes un campo imagen en la BD -->
        <img th:src="@{/assets/KitDeArrastre.png}" alt="Kit de arrastre">
        <h5 th:text="${producto.nombre}">Nombre producto</h5>
        <p th:text="${producto.descripcion}">Descripción</p>
        <p><strong>Precio:</strong> $<span th:text="${producto.precio}">0.00</span></p>
        <a th:href="@{/ComparacionProductos(id=${producto.idProducto})}" class="btn-accion">Ficha técnica</a>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="actions">
      <div class="left">
        <button onclick="history.back()" class="btn-accion">Atrás</button>
      </div>
      <div>
        <a th:href="@{/ComunicacionTec}" class="btn-accion">Comunicate con un técnico</a>
      </div>
      <div class="right">
        <button onclick="desmarcarProductos()" class="btn-accion">Desmarcar productos</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    function toggleSelect(circle) {
      circle.classList.toggle('selected');
    }
    document.getElementById("userIcon").addEventListener("click", function() {
      document.getElementById("dropdown").classList.toggle("hidden");
    });
    window.addEventListener("click", function(e) {
      if (!document.querySelector(".user-menu").contains(e.target)) {
        document.getElementById("dropdown").classList.add("hidden");
      }
    });
    function desmarcarProductos() {
      const selects = document.querySelectorAll(".select-circle");
      selects.forEach(s => s.classList.remove("selected"));
    }
  </script>
</body>
</html>